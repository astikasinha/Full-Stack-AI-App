{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 66, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/astik/Downloads/astikachatbotapp/app/config/db.js"],"sourcesContent":["import mongoose from \"mongoose\";\r\n\r\nlet cached = global.mongoose || { conn: null, promise: null };\r\n\r\nexport default async function connectDB() {\r\n  if (cached.conn) return cached.conn;\r\n\r\n  if (!cached.promise) {\r\n    cached.promise = mongoose.connect(process.env.MONGODB_URI).then((mongoose) => mongoose);\r\n  }\r\n\r\n  try {\r\n    cached.conn = await cached.promise;\r\n  } catch (error) {\r\n    console.error(\"Error connecting to MongoDB:\", error);\r\n  }\r\n\r\n  return cached.conn;\r\n}\r\n"],"names":[],"mappings":";;;AAAA;;AAEA,IAAI,SAAS,4CAAO,QAAQ,IAAI;IAAE,MAAM;IAAM,SAAS;AAAK;AAE7C,eAAe;IAC5B,IAAI,OAAO,IAAI,EAAE,OAAO,OAAO,IAAI;IAEnC,IAAI,CAAC,OAAO,OAAO,EAAE;QACnB,OAAO,OAAO,GAAG,yGAAA,CAAA,UAAQ,CAAC,OAAO,CAAC,QAAQ,GAAG,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC,WAAa;IAChF;IAEA,IAAI;QACF,OAAO,IAAI,GAAG,MAAM,OAAO,OAAO;IACpC,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gCAAgC;IAChD;IAEA,OAAO,OAAO,IAAI;AACpB","debugId":null}},
    {"offset": {"line": 91, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/astik/Downloads/astikachatbotapp/app/models/Chat.js"],"sourcesContent":["import mongoose from \"mongoose\";\r\nconst ChatSchema=new mongoose.Schema(\r\n    {\r\n        \r\n        name: {type:String,required: true},\r\n        messages:[\r\n            {\r\n                role: {type:String,required: true},\r\n                content: {type:String,required: true},\r\n                timestamp: {type:Number,required: true},\r\n\r\n            }\r\n        ],\r\n        userId: {type:String,required: true},\r\n\r\n    },\r\n    {timestamps: true}\r\n);\r\n\r\nconst Chat=mongoose.models.Chat || mongoose.model(\"Chat\",ChatSchema)\r\nexport default Chat;"],"names":[],"mappings":";;;AAAA;;AACA,MAAM,aAAW,IAAI,yGAAA,CAAA,UAAQ,CAAC,MAAM,CAChC;IAEI,MAAM;QAAC,MAAK;QAAO,UAAU;IAAI;IACjC,UAAS;QACL;YACI,MAAM;gBAAC,MAAK;gBAAO,UAAU;YAAI;YACjC,SAAS;gBAAC,MAAK;gBAAO,UAAU;YAAI;YACpC,WAAW;gBAAC,MAAK;gBAAO,UAAU;YAAI;QAE1C;KACH;IACD,QAAQ;QAAC,MAAK;QAAO,UAAU;IAAI;AAEvC,GACA;IAAC,YAAY;AAAI;AAGrB,MAAM,OAAK,yGAAA,CAAA,UAAQ,CAAC,MAAM,CAAC,IAAI,IAAI,yGAAA,CAAA,UAAQ,CAAC,KAAK,CAAC,QAAO;uCAC1C","debugId":null}},
    {"offset": {"line": 146, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/astik/Downloads/astikachatbotapp/app/api/chat/ai/route.js"],"sourcesContent":["import connectDB from \"../../../config/db\";\r\nimport Chat from \"../../../models/Chat\";\r\nimport { NextResponse } from \"next/server\";\r\nimport { GoogleGenerativeAI } from \"@google/generative-ai\"; \r\nimport { getAuth } from \"@clerk/nextjs/server\";\r\n\r\nexport async function POST(req) {\r\n  await connectDB();\r\n\r\n  const { userId } = getAuth(req);\r\n  const { chatId, prompt } = await req.json();\r\n\r\n  if (!userId) {\r\n    return NextResponse.json({ success: false, message: \"Unauthorized\" }, { status: 401 });\r\n  }\r\n\r\n  try {\r\n    const genAI = new GoogleGenerativeAI(process.env.API_KEY);\r\n    const model = genAI.getGenerativeModel({ model: \"gemini-1.5-flash\" });\r\n\r\n    const result = await model.generateContent(prompt);\r\n    const response = result.response;\r\n    const text = await response.text();\r\n\r\n    const assistantMessage = {\r\n      role: \"assistant\",\r\n      content: text,\r\n      timestamp: Date.now(),\r\n    };\r\n\r\n    await Chat.findByIdAndUpdate(chatId, {\r\n      $push: {\r\n        messages: [\r\n          {\r\n            role: \"user\",\r\n            content: prompt,\r\n            timestamp: Date.now(),\r\n          },\r\n          assistantMessage,\r\n        ],\r\n      },\r\n      $set: {\r\n        updatedAt: new Date(),\r\n      },\r\n    });\r\n\r\n    return NextResponse.json({ success: true, data: assistantMessage });\r\n  } catch (error) {\r\n    console.error(\"AI Chat Error:\", error);\r\n    return NextResponse.json({ success: false, message: \"Failed to generate response\", error: error.message });\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;AAAA;AACA;AACA;AACA;AACA;;;;;;AAEO,eAAe,KAAK,GAAG;IAC5B,MAAM,CAAA,GAAA,qHAAA,CAAA,UAAS,AAAD;IAEd,MAAM,EAAE,MAAM,EAAE,GAAG,CAAA,GAAA,6KAAA,CAAA,UAAO,AAAD,EAAE;IAC3B,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,IAAI,IAAI;IAEzC,IAAI,CAAC,QAAQ;QACX,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAO,SAAS;QAAe,GAAG;YAAE,QAAQ;QAAI;IACtF;IAEA,IAAI;QACF,MAAM,QAAQ,IAAI,gKAAA,CAAA,qBAAkB,CAAC,QAAQ,GAAG,CAAC,OAAO;QACxD,MAAM,QAAQ,MAAM,kBAAkB,CAAC;YAAE,OAAO;QAAmB;QAEnE,MAAM,SAAS,MAAM,MAAM,eAAe,CAAC;QAC3C,MAAM,WAAW,OAAO,QAAQ;QAChC,MAAM,OAAO,MAAM,SAAS,IAAI;QAEhC,MAAM,mBAAmB;YACvB,MAAM;YACN,SAAS;YACT,WAAW,KAAK,GAAG;QACrB;QAEA,MAAM,uHAAA,CAAA,UAAI,CAAC,iBAAiB,CAAC,QAAQ;YACnC,OAAO;gBACL,UAAU;oBACR;wBACE,MAAM;wBACN,SAAS;wBACT,WAAW,KAAK,GAAG;oBACrB;oBACA;iBACD;YACH;YACA,MAAM;gBACJ,WAAW,IAAI;YACjB;QACF;QAEA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM,MAAM;QAAiB;IACnE,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,kBAAkB;QAChC,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAO,SAAS;YAA+B,OAAO,MAAM,OAAO;QAAC;IAC1G;AACF","debugId":null}}]
}